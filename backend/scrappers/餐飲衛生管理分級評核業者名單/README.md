# 餐飲衛生管理分級評核業者名單資料處理工具

這個工具用於從台北市政府衛生局下載餐飲衛生管理分級評核業者名單，並轉換為簡潔的 JSON 格式。

## 功能特色

- 🌐 自動從台北市資料大平台下載最新資料（不儲存 CSV）
- 🧹 智能處理資料，過濾重複登錄字號
- 📊 輸出簡潔的 JSON 格式：`{食品業者登錄字號: 評核結果}`
- 💾 原子寫入操作，確保資料安全
- 📈 顯示統計資訊

## 使用方法

### 執行程式

```bash
cd 餐飲衛生管理分級評核業者名單
python fetch_restaurant_ratings.py
```

### 輸出檔案

程式會自動生成以下檔案：

- `餐飲衛生管理分級評核業者名單.json` - JSON 格式資料

## 資料格式

### 輸出 JSON 格式

```json
{
  "A-153353122-00747-0": "優",
  "A-116098275-00015-2": "優",
  "A-101494522-00001-6": "良"
}
```

- **Key**: 食品業者登錄字號
- **Value**: 評核結果（"優" 或 "良"）

### 原始資料欄位

來自台北市政府衛生局的 CSV 檔案包含以下欄位：

- 行政區域代碼
- 業者名稱店名
- 食品業者登錄字號
- 地址
- 評核結果

## 資料來源

- **台北市政府衛生局** - 餐飲衛生管理分級評核專區
  - https://health.gov.taipei/News.aspx?n=DE4B43F114D94B4F&sms=F8548A1E404339A3

- **台北市資料大平台**
  - https://data.taipei

## 統計資訊（113 年度）

- 總業者數：1,575 家
- 優級：1,554 家（98.7%）
- 良級：21 家（1.3%）

## 技術特點

- **不儲存中間檔案**：直接從 URL 下載並處理，不儲存 CSV 到硬碟
- **原子寫入**：使用臨時文件 + 重命名，確保資料完整性
- **智能去重**：自動處理重複的登錄字號，並顯示警告
- **UTF-8 BOM 處理**：自動處理 CSV 檔案的 BOM 標記

## 關於餐飲衛生管理分級評核

餐飲衛生管理分級評核制度是台北市政府衛生局為鼓勵符合食品良好衛生規範（GHP）之優良餐飲業，繼續維持 GHP 規範、做好衛生自我管理而實施的制度。

評核結果分為兩級：
- **優級**：符合優良衛生規範標準
- **良級**：符合良好衛生規範標準

## 程式碼說明

主要函數：

1. `download_csv_from_url()` - 從 URL 下載 CSV（不儲存）
2. `parse_restaurant_ratings()` - 解析 CSV 資料
3. `save_to_json()` - 儲存為 JSON 格式
4. `print_statistics()` - 顯示統計資訊

## 注意事項

- 程式會自動處理重複的登錄字號
- 如果同一登錄字號有不同的評核結果，會顯示警告
- CSV 下載連結可能會變更，請至台北市資料大平台確認最新連結

## 更新下載連結

如果 CSV 下載連結失效，請：

1. 前往 https://data.taipei
2. 搜尋「餐飲衛生管理分級評核」
3. 找到最新的資料集
4. 複製下載連結
5. 更新 `fetch_restaurant_ratings.py` 中的 `CSV_URL` 變數
